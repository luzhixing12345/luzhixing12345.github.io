

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://raw.githubusercontent.com/learner-lu/picbed/master/logo.png">
  <link rel="icon" href="https://raw.githubusercontent.com/learner-lu/picbed/master/logo.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#4a00e0">
  <meta name="author" content="luzhixing12345">
  <meta name="keywords" content="">
  
    <meta name="description" content="前言 tar xvf datalab-handout.tar 解压缩之后可以看到本次实验使用的是gcc工具,打开Makefile文件可以看到使用了-m32进行了编译 所以如果在编译的时候报错了还需要安装32位的gcc编译器 sudo apt-get install gcc-multilib 位运算运算符优先级    运算符 优先级     () 1   -(单目) ! ~ 2   * &#x2F; % 3">
<meta property="og:type" content="article">
<meta property="og:title" content="01-DataLab">
<meta property="og:url" content="https://luzhixing12345.github.io/2022/10/22/CSAPP/01-DataLab/index.html">
<meta property="og:site_name" content="kamilu的博客">
<meta property="og:description" content="前言 tar xvf datalab-handout.tar 解压缩之后可以看到本次实验使用的是gcc工具,打开Makefile文件可以看到使用了-m32进行了编译 所以如果在编译的时候报错了还需要安装32位的gcc编译器 sudo apt-get install gcc-multilib 位运算运算符优先级    运算符 优先级     () 1   -(单目) ! ~ 2   * &#x2F; % 3">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-10-21T17:46:00.000Z">
<meta property="article:modified_time" content="2023-02-02T04:32:06.044Z">
<meta property="article:author" content="luzhixing12345">
<meta property="article:tag" content="CSAPP">
<meta name="twitter:card" content="summary_large_image">
  
  
  <title>01-DataLab - kamilu的博客</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"luzhixing12345.github.io","root":"/","version":"1.8.14","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"fEy8W8VvIoc26nT53dV2157j-gzGzoHsz","app_key":"s9HXuqmvBWrOaAiLA07Jg59A","server_url":"https://fey8w8vv.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.1.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Kamilu-blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://raw.githubusercontent.com/learner-lu/picbed/master/background.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="01-DataLab">
              
                01-DataLab
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-10-22 01:46" pubdate>
        2022年10月22日 凌晨
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      6.2k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      52 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">01-DataLab</h1>
            
              <p class="note note-info">
                
                  本文最后更新于：1 个月前
                
              </p>
            
            <div class="markdown-body">
              <h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2>
<div class="code-wrapper"><pre><code class="hljs bash">tar xvf datalab-handout.tar</code></pre></div>
<p>解压缩之后可以看到本次实验使用的是gcc工具,打开Makefile文件可以看到使用了-m32进行了编译</p>
<p>所以如果在编译的时候报错了还需要安装32位的gcc编译器</p>
<div class="code-wrapper"><pre><code class="hljs bash">sudo apt-get install gcc-multilib</code></pre></div>
<p>位运算运算符优先级</p>
<table>
<thead>
<tr>
<th style="text-align:center">运算符</th>
<th style="text-align:center">优先级</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">()</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">-(单目) ! ~</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">* / %</td>
<td style="text-align:center">3</td>
</tr>
<tr>
<td style="text-align:center">+ -</td>
<td style="text-align:center">4</td>
</tr>
<tr>
<td style="text-align:center">&lt;&lt; &gt;&gt;</td>
<td style="text-align:center">5</td>
</tr>
<tr>
<td style="text-align:center">&gt; &gt;= &lt; &lt;=</td>
<td style="text-align:center">6</td>
</tr>
<tr>
<td style="text-align:center">== !=</td>
<td style="text-align:center">7</td>
</tr>
<tr>
<td style="text-align:center">&amp;</td>
<td style="text-align:center">8</td>
</tr>
<tr>
<td style="text-align:center">^</td>
<td style="text-align:center">9</td>
</tr>
<tr>
<td style="text-align:center">|</td>
<td style="text-align:center">10</td>
</tr>
</tbody>
</table>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/4752611">完整运算符优先级</a></p>
</blockquote>
<h2 id="实验解答"><a class="markdownIt-Anchor" href="#实验解答"></a> 实验解答</h2>
<div class="code-wrapper"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">bitXor</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> &#123;
  <span class="hljs-keyword">return</span> ~(x&amp;y)&amp;~(~x&amp;~y);
&#125;
<span class="hljs-comment">/*</span>
<span class="hljs-comment"> * tmin - return minimum two&#x27;s complement integer</span>
<span class="hljs-comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span>
<span class="hljs-comment"> *   Max ops: 4</span>
<span class="hljs-comment"> *   Rating: 1</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">tmin</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> &#123;
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">31</span>;
&#125;
<span class="hljs-comment">//2</span>
<span class="hljs-comment">/*</span>
<span class="hljs-comment"> * isTmax - returns 1 if x is the maximum, two&#x27;s complement number,</span>
<span class="hljs-comment"> *     and 0 otherwise</span>
<span class="hljs-comment"> *   Legal ops: ! ~ &amp; ^ | +</span>
<span class="hljs-comment"> *   Max ops: 10</span>
<span class="hljs-comment"> *   Rating: 1</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">isTmax</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;
    <span class="hljs-keyword">return</span> !((~(x+<span class="hljs-number">1</span>)^x))&amp;!!(x+<span class="hljs-number">1</span>);
&#125;
<span class="hljs-comment">/*</span>
<span class="hljs-comment"> * allOddBits - return 1 if all odd-numbered bits in word set to 1</span>
<span class="hljs-comment"> *   where bits are numbered from 0 (least significant) to 31 (most significant)</span>
<span class="hljs-comment"> *   Examples allOddBits(0xFFFFFFFD) = 0, allOddBits(0xAAAAAAAA) = 1</span>
<span class="hljs-comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span>
<span class="hljs-comment"> *   Max ops: 12</span>
<span class="hljs-comment"> *   Rating: 2</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">allOddBits</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;
    <span class="hljs-type">int</span> mask = <span class="hljs-number">0xaa</span> | <span class="hljs-number">0xaa</span> &lt;&lt; <span class="hljs-number">8</span>;
    mask = mask | mask &lt;&lt; <span class="hljs-number">16</span>;
    <span class="hljs-keyword">return</span> !((x&amp;mask)^mask);
&#125;
<span class="hljs-comment">/*</span>
<span class="hljs-comment"> * negate - return -x</span>
<span class="hljs-comment"> *   Example: negate(1) = -1.</span>
<span class="hljs-comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span>
<span class="hljs-comment"> *   Max ops: 5</span>
<span class="hljs-comment"> *   Rating: 2</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">negate</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;
    <span class="hljs-keyword">return</span> ~x+<span class="hljs-number">1</span>;
&#125;
<span class="hljs-comment">//3</span>
<span class="hljs-comment">/*</span>
<span class="hljs-comment"> * isAsciiDigit - return 1 if 0x30 &lt;= x &lt;= 0x39 (ASCII codes for characters &#x27;0&#x27; to &#x27;9&#x27;)</span>
<span class="hljs-comment"> *   Example: isAsciiDigit(0x35) = 1.</span>
<span class="hljs-comment"> *            isAsciiDigit(0x3a) = 0.</span>
<span class="hljs-comment"> *            isAsciiDigit(0x05) = 0.</span>
<span class="hljs-comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span>
<span class="hljs-comment"> *   Max ops: 15</span>
<span class="hljs-comment"> *   Rating: 3</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">isAsciiDigit</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;
    <span class="hljs-type">int</span> first_match = !(x&gt;&gt;<span class="hljs-number">4</span>^<span class="hljs-number">3</span>);
    <span class="hljs-type">int</span> second_match = (~<span class="hljs-number">0xa</span>+<span class="hljs-number">1</span>+(x&amp;<span class="hljs-number">0xf</span>))&gt;&gt;<span class="hljs-number">31</span>&amp;<span class="hljs-number">1</span>;
    <span class="hljs-keyword">return</span> first_match &amp; second_match;
&#125;
<span class="hljs-comment">/*</span>
<span class="hljs-comment"> * conditional - same as x ? y : z</span>
<span class="hljs-comment"> *   Example: conditional(2,4,5) = 4</span>
<span class="hljs-comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span>
<span class="hljs-comment"> *   Max ops: 16</span>
<span class="hljs-comment"> *   Rating: 3</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">conditional</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, <span class="hljs-type">int</span> z)</span> &#123;
    <span class="hljs-type">int</span> mask = !x + ~<span class="hljs-number">0</span>;
    <span class="hljs-keyword">return</span> (mask &amp; y) | (~mask &amp;z);
&#125;
<span class="hljs-comment">/*</span>
<span class="hljs-comment"> * isLessOrEqual - if x &lt;= y  then return 1, else return 0</span>
<span class="hljs-comment"> *   Example: isLessOrEqual(4,5) = 1.</span>
<span class="hljs-comment"> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span>
<span class="hljs-comment"> *   Max ops: 24</span>
<span class="hljs-comment"> *   Rating: 3</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">isLessOrEqual</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> &#123;
    <span class="hljs-type">int</span> judge = !((y+~x+<span class="hljs-number">1</span>)&gt;&gt;<span class="hljs-number">31</span>);
    <span class="hljs-type">int</span> same_signal = !((x^y)&gt;&gt;<span class="hljs-number">31</span>);
    <span class="hljs-type">int</span> x_neg_y_pos = (x&gt;&gt;<span class="hljs-number">31</span>)&amp;!(y&gt;&gt;<span class="hljs-number">31</span>);
    <span class="hljs-keyword">return</span> x_neg_y_pos | (same_signal &amp; judge);
&#125;
<span class="hljs-comment">//4</span>
<span class="hljs-comment">/*</span>
<span class="hljs-comment"> * logicalNeg - implement the ! operator, using all of</span>
<span class="hljs-comment"> *              the legal operators except !</span>
<span class="hljs-comment"> *   Examples: logicalNeg(3) = 0, logicalNeg(0) = 1</span>
<span class="hljs-comment"> *   Legal ops: ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span>
<span class="hljs-comment"> *   Max ops: 12</span>
<span class="hljs-comment"> *   Rating: 4</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">logicalNeg</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;
    <span class="hljs-type">int</span> a = (x&amp;(~x+<span class="hljs-number">1</span>));
    <span class="hljs-type">int</span> b = a + ~<span class="hljs-number">0</span>;
    <span class="hljs-type">int</span> c = b &gt;&gt; <span class="hljs-number">31</span>;
    <span class="hljs-keyword">return</span> ~c + <span class="hljs-number">1</span>;
&#125;
<span class="hljs-comment">/* howManyBits - return the minimum number of bits required to represent x in</span>
<span class="hljs-comment"> *             two&#x27;s complement</span>
<span class="hljs-comment"> *  Examples: howManyBits(12) = 5</span>
<span class="hljs-comment"> *            howManyBits(298) = 10</span>
<span class="hljs-comment"> *            howManyBits(-5) = 4</span>
<span class="hljs-comment"> *            howManyBits(0)  = 1</span>
<span class="hljs-comment"> *            howManyBits(-1) = 1</span>
<span class="hljs-comment"> *            howManyBits(0x80000000) = 32</span>
<span class="hljs-comment"> *  Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;</span>
<span class="hljs-comment"> *  Max ops: 90</span>
<span class="hljs-comment"> *  Rating: 4</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">howManyBits</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;
    <span class="hljs-type">int</span> b16,b8,b4,b2,b1,b0;
    <span class="hljs-type">int</span> flag = x&gt;&gt;<span class="hljs-number">31</span>;
    x = (flag&amp;~x) | (~flag&amp;x); <span class="hljs-comment">//x为非正数则不变 ,x 为负数 则相当于按位取反</span>
    b16 = !!(x&gt;&gt;<span class="hljs-number">16</span>) &lt;&lt;<span class="hljs-number">4</span>; <span class="hljs-comment">//如果高16位不为0,则我们让b16=16</span>
    x&gt;&gt;=b16; <span class="hljs-comment">//如果高16位不为0 则我们右移动16位 来看高16位的情况</span>
    <span class="hljs-comment">//下面过程基本类似</span>
    b8=!!(x&gt;&gt;<span class="hljs-number">8</span>)&lt;&lt;<span class="hljs-number">3</span>;
    x &gt;&gt;= b8;
    b4 = !!(x &gt;&gt; <span class="hljs-number">4</span>) &lt;&lt; <span class="hljs-number">2</span>;
    x &gt;&gt;= b4;
    b2 = !!(x &gt;&gt; <span class="hljs-number">2</span>) &lt;&lt; <span class="hljs-number">1</span>;
    x &gt;&gt;= b2;
    b1 = !!(x &gt;&gt; <span class="hljs-number">1</span>);
    x &gt;&gt;= b1;
    b0 = x;
    <span class="hljs-keyword">return</span> b0+b1+b2+b4+b8+b16+<span class="hljs-number">1</span>;
&#125;
<span class="hljs-comment">//float</span>
<span class="hljs-comment">/*</span>
<span class="hljs-comment"> * floatScale2 - Return bit-level equivalent of expression 2*f for</span>
<span class="hljs-comment"> *   floating point argument f.</span>
<span class="hljs-comment"> *   Both the argument and result are passed as unsigned int&#x27;s, but</span>
<span class="hljs-comment"> *   they are to be interpreted as the bit-level representation of</span>
<span class="hljs-comment"> *   single-precision floating point values.</span>
<span class="hljs-comment"> *   When argument is NaN, return argument</span>
<span class="hljs-comment"> *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while</span>
<span class="hljs-comment"> *   Max ops: 30</span>
<span class="hljs-comment"> *   Rating: 4</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">unsigned</span> <span class="hljs-title function_">floatScale2</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> uf)</span> &#123;
    <span class="hljs-type">int</span> exp_mask = <span class="hljs-number">0x7f800000</span>;
    <span class="hljs-type">int</span> <span class="hljs-built_in">exp</span> = (uf&amp;exp_mask)&gt;&gt;<span class="hljs-number">23</span>;
    <span class="hljs-type">int</span> frac_mask = <span class="hljs-number">0x7fffff</span>;
    <span class="hljs-type">int</span> frac = uf &amp; frac_mask;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">exp</span> == <span class="hljs-number">0</span>) &#123;
        <span class="hljs-keyword">if</span> (frac&gt;&gt;<span class="hljs-number">23</span>&amp;<span class="hljs-number">1</span>) &#123;
            frac = frac * <span class="hljs-number">2</span> - <span class="hljs-number">0x7fffff</span>;
        &#125; <span class="hljs-keyword">else</span> &#123;
            frac = frac &lt;&lt; <span class="hljs-number">1</span>;
        &#125;
        <span class="hljs-keyword">return</span> (uf &amp; ~frac_mask) | frac;
    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">exp</span> == <span class="hljs-number">255</span>) &#123;
        <span class="hljs-keyword">return</span> uf;
    &#125; <span class="hljs-keyword">else</span> &#123;
        <span class="hljs-keyword">return</span> (uf &amp; ~exp_mask) | (<span class="hljs-built_in">exp</span>+<span class="hljs-number">1</span>)&lt;&lt;<span class="hljs-number">23</span>;
    &#125;
&#125;
<span class="hljs-comment">/*</span>
<span class="hljs-comment"> * floatFloat2Int - Return bit-level equivalent of expression (int) f</span>
<span class="hljs-comment"> *   for floating point argument f.</span>
<span class="hljs-comment"> *   Argument is passed as unsigned int, but</span>
<span class="hljs-comment"> *   it is to be interpreted as the bit-level representation of a</span>
<span class="hljs-comment"> *   single-precision floating point value.</span>
<span class="hljs-comment"> *   Anything out of range (including NaN and infinity) should return</span>
<span class="hljs-comment"> *   0x80000000u.</span>
<span class="hljs-comment"> *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while</span>
<span class="hljs-comment"> *   Max ops: 30</span>
<span class="hljs-comment"> *   Rating: 4</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">floatFloat2Int</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> uf)</span> &#123;
    <span class="hljs-type">int</span> exp_mask = <span class="hljs-number">0x7f800000</span>;
    <span class="hljs-type">int</span> frac_mask = <span class="hljs-number">0x7fffff</span>;
    <span class="hljs-type">int</span> <span class="hljs-built_in">exp</span> = (uf &amp; exp_mask)&gt;&gt;<span class="hljs-number">23</span>;
    <span class="hljs-type">int</span> frac = uf &amp; frac_mask;
    <span class="hljs-type">int</span> signal = uf&gt;&gt;<span class="hljs-number">31</span>&amp;<span class="hljs-number">1</span>;
    <span class="hljs-type">int</span> bias;
    <span class="hljs-type">int</span> ans;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">exp</span> &lt; <span class="hljs-number">127</span>) &#123;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">exp</span> == <span class="hljs-number">255</span> || <span class="hljs-built_in">exp</span> &gt; <span class="hljs-number">127</span>+<span class="hljs-number">31</span>) &#123;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0x80000000</span>;
    &#125; <span class="hljs-keyword">else</span> &#123;
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">exp</span>==<span class="hljs-number">127</span>+<span class="hljs-number">31</span>)&#123;
            <span class="hljs-keyword">if</span> (frac==<span class="hljs-number">0</span> &amp;&amp; signal == <span class="hljs-number">1</span>) &#123;
                <span class="hljs-keyword">return</span> <span class="hljs-number">0x80000000</span>;
            &#125; <span class="hljs-keyword">else</span> &#123;
                <span class="hljs-keyword">return</span> <span class="hljs-number">0x80000000</span>;
            &#125;
        &#125; <span class="hljs-keyword">else</span> &#123;
            bias = <span class="hljs-built_in">exp</span><span class="hljs-number">-127</span>;
            <span class="hljs-keyword">if</span> (bias &gt;= <span class="hljs-number">23</span>) &#123;
                ans = (<span class="hljs-number">1</span>&lt;&lt;bias) + (<span class="hljs-number">1</span>&lt;&lt;bias&gt;&gt;<span class="hljs-number">23</span>)*frac;
            &#125; <span class="hljs-keyword">else</span> &#123;
                ans = <span class="hljs-number">1</span>&lt;&lt;bias;
            &#125;
            <span class="hljs-keyword">return</span> signal ? -ans:ans;
        &#125;
    &#125;
&#125;
<span class="hljs-comment">/*</span>
<span class="hljs-comment"> * floatPower2 - Return bit-level equivalent of the expression 2.0^x</span>
<span class="hljs-comment"> *   (2.0 raised to the power x) for any 32-bit integer x.</span>
<span class="hljs-comment"> *</span>
<span class="hljs-comment"> *   The unsigned value that is returned should have the identical bit</span>
<span class="hljs-comment"> *   representation as the single-precision floating-point number 2.0^x.</span>
<span class="hljs-comment"> *   If the result is too small to be represented as a denorm, return</span>
<span class="hljs-comment"> *   0. If too large, return +INF.</span>
<span class="hljs-comment"> *</span>
<span class="hljs-comment"> *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. Also if, while</span>
<span class="hljs-comment"> *   Max ops: 30</span>
<span class="hljs-comment"> *   Rating: 4</span>
<span class="hljs-comment"> */</span>
<span class="hljs-type">unsigned</span> <span class="hljs-title function_">floatPower2</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> &#123;
    <span class="hljs-type">int</span> frac, <span class="hljs-built_in">exp</span>;
    <span class="hljs-keyword">if</span> (x &lt; <span class="hljs-number">-149</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x &gt;= <span class="hljs-number">-149</span> &amp;&amp; x &lt;= <span class="hljs-number">-127</span>) &#123;
        frac = x+<span class="hljs-number">149</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> &lt;&lt; frac;
    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x&lt;<span class="hljs-number">128</span>) &#123;
        <span class="hljs-built_in">exp</span> = x+<span class="hljs-number">127</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">exp</span> &lt;&lt; <span class="hljs-number">23</span>;
    &#125; <span class="hljs-keyword">else</span> &#123;
        <span class="hljs-keyword">return</span> <span class="hljs-number">255</span> &lt;&lt; <span class="hljs-number">23</span>;
    &#125;
&#125;</code></pre></div>
<p>我自己的做的时候 <code>howManyBits</code> 不知道怎么做,上网查的答案</p>
<p>其他的题目也都不是特别困难,看一下位运算应该也可以看懂</p>
<h2 id="编译运行"><a class="markdownIt-Anchor" href="#编译运行"></a> 编译运行</h2>
<div class="code-wrapper"><pre><code class="hljs bash">make
<span class="hljs-comment"># 编译会有一个警告,忽略即可</span>
<span class="hljs-comment"># 检查正确性,如果没有输出则说明所有函数实现符合要求,否则需要修改</span>
./dlc bits.c
./btest</code></pre></div>
<div class="code-wrapper"><pre><code class="hljs bash">root@da1811a84ddc:~/csapplabs/01Data Lab/datalab-handout<span class="hljs-comment"># ./dlc bits.c</span>
root@da1811a84ddc:~/csapplabs/01Data Lab/datalab-handout<span class="hljs-comment"># ./btest</span>
Score   Rating  Errors  Function
 1      1       0       bitXor
 1      1       0       tmin
 1      1       0       isTmax
 2      2       0       allOddBits
 2      2       0       negate
 3      3       0       isAsciiDigit
 3      3       0       conditional
 3      3       0       isLessOrEqual
 4      4       0       logicalNeg
 4      4       0       howManyBits
 4      4       0       floatScale2
 4      4       0       floatFloat2Int
ERROR: Test floatPower2 failed.
  Timed out after 10 secs (probably infinite loop)
Total points: 32/36</code></pre></div>
<p>最后的 <code>floatPower2</code> 超时是因为测试案例太多了,修改btest.c中的TIMEOUT_LIMIT宏,重新编译后通过</p>
<div class="code-wrapper"><pre><code class="hljs c"><span class="hljs-comment">// btest.c</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> TIMEOUT_LIMIT 20</span></code></pre></div>
<div class="code-wrapper"><pre><code class="hljs bash">root@da1811a84ddc:~/csapplabs/01Data Lab/datalab-handout<span class="hljs-comment"># ./btest</span>
Score   Rating  Errors  Function
 1      1       0       bitXor
 1      1       0       tmin
 1      1       0       isTmax
 2      2       0       allOddBits
 2      2       0       negate
 3      3       0       isAsciiDigit
 3      3       0       conditional
 3      3       0       isLessOrEqual
 4      4       0       logicalNeg
 4      4       0       howManyBits
 4      4       0       floatScale2
 4      4       0       floatFloat2Int
 4      4       0       floatPower2
Total points: 36/36</code></pre></div>
<p>关于浮点数的知识笔者留下的印象也不多了,故特做了一文<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/580191161?">计算机系统基础：浮点数的表示</a></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/CSAPP/">CSAPP</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/10/23/%E6%9D%82/%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87%E7%9A%84%E6%8A%A5%E9%94%99/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">疑难杂症的报错</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/10/21/CSAPP/%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/">
                        <span class="hidden-mobile">00-实验环境准备</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  










  

  
    <!-- KaTeX -->
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css" />
  











<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
